 {Project: EE-9 Platform: Parallax Project USB Board Revision: Author: Dillon Chew Date: 28 Nov 2021 Log:   Date: Desc         26/11/2021: Redid the logic of the main function}CON  _clkmode = xtal1 + pll16x     'Standard clock mode * crystal frequency = 80 MHz  _xinfreq = 5_000_000  _ConClkFreq = ((_clkmode - xtal1 >> 6) * _xinfreq)  '_Ms_001 = _ConClkFreq / 1_000  'Ultrasonic 1 (Front)  - I2C Bus 1  ultra1SCL = 6  ultra1SDA = 7  'Ultrasonic 2 (Back)  - I2C Bus 2  ultra2SCL = 8  ultra2SDA = 9  'TOF1  tof1SCL= 0  'clk  tof1SDA= 1  'data  tof1RST= 14 'reset pin  tofAdd= $29   'default address is $29  'TOF2                                                                                                                                                                                                     ,  tof2RST= 15  tof2SCL= 2  tof2SDA= 3 'reset pinVAR  long cogStack[64] 'Stack space for cog  long cogIDNum  long _Ms_001OBJ  'Term      : "FullDuplexSerial.Spin"  Ultra     : "EE-7_Ultra.spin"  ToF[2]    : "EE-7_Tof.spin"PUB Start (mainMSVal, mainToF1Add, mainToF2Add, mainUltra1Add, mainUltra2Add)  _Ms_001 := mainMSVal  Stop  cogIDNum:=cognew(sensorCore(mainToF1Add, mainToF2Add, mainUltra1Add, mainUltra2Add), @cogStack) 'initialise in new core  returnPUB Stop          'stop running core  if cogIDNum    cogstop(cogIDNum~)PUB sensorCore(mainToF1Add, mainToF2Add, mainUltra1Add, mainUltra2Add)  Ultra.Init(ultra1SCL,ultra1SDA,0)  'initialise both ultrasonic sensors  Ultra.Init(ultra2SCL,ultra2SDA,1)  tofInit                            'initialise tof sensors  repeat    long[mainUltra1Add] := Ultra.readSensor(0)           'reading and sending back values of ultrasonic and tof sensors to mylitekit    long[mainUltra2Add] := Ultra.readSensor(1)    long[mainToF1Add]   := ToF[0].GetSingleRange(tofAdd)    long[mainToF2Add]   := ToF[1].GetSingleRange(tofAdd)    Pause(50)PRI tofInit | i{{ }}  ToF[0].Init(tof1SCL, tof1SDA, tof1RST)  ToF[0].ChipReset(1)  Pause(1000)  ToF[0].FreshReset(tofAdd)  ToF[0].MandatoryLoad(tofAdd)  ToF[0].RecommendedLoad(tofAdd)  ToF[0].FreshReset(tofAdd)  ToF[1].Init(tof2SCL, tof2SDA, tof2RST)  ToF[1].ChipReset(1)  Pause(1000)  ToF[1].FreshReset(tofAdd)  ToF[1].MandatoryLoad(tofAdd)  ToF[1].RecommendedLoad(tofAdd)  ToF[1].FreshReset(tofAdd)  returnPRI Pause (ms) | t  t := cnt - 1088  repeat (ms#>0)    waitcnt (t+=_Ms_001)  returnDATname    byte  "string_data",0